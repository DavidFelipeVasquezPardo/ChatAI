// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

//Creacion usuario:-----------------------------------------------------------------------------------------------------------------------------------------------------
model informacionUsuario {
  idUsuario        String @id @unique @default(uuid())
  nombre           String
  apellido         String?
  correo           String @unique
  telefonoPersonal String @unique
  telefonoFamiliar String

  //Asistente Psicologico:
  chats               chats[]               @relation("conexionChats")
  credenciales        credencial[]          @relation("conexionCredencial")
  
  //sociodemografico:
  informacionPersonal informacionPersonal[] @relation("conexionInformacionPersonal")
  condicionesVivienda condicionesvivienda[] @relation("conexionCondicionesVivienda")
  educacion           educacion[]           @relation("conexionEducacion")
  situcionlaboral     situacionlaboral[]    @relation("conexionSituacionLaboral")
  Salud               salud[]               @relation("conexionSalud")

  //GHQ12:
  GHQ12Id        GHQ12[]@relation("conexionidGHQ12")
  GHQ12Tel       GHQ12[]@relation("conexionHistorialTel")

  @@map("informacion_usuario")
}
//----------------------------------------------------------------------------------------------------------------------------------------------------------------------

//Asistente Psicologico:------------------------------------------------------------------------------------------------------------------------------------------------
model chats {
  idchat  String  @id @unique @default(uuid())
  idUsuario String
  fechaHora DateTime @default(now())
  conversacion Json

  usuarioChats informacionUsuario @relation(fields: [idUsuario], references: [idUsuario], name: "conexionChats")

  @@map("chats")
}

model credencial {
  idCredencial String @id @unique @default(uuid())
  idUsuario    String
  usuario      String
  contrasena   String
  rol          String @default("user")

  usuarioCredencial informacionUsuario @relation(fields: [idUsuario], references: [idUsuario], name: "conexionCredencial")

  @@map("credencial")
}
//Sociodemografico:
model informacionPersonal {
  idinformacionPersonal String @id @unique @default(uuid())
  idUsuario             String

  edad          Int
  sexo          String
  genero        String
  estadocivil   String
  hijosnum      Int
  personascargo Int
  vivienda      String
  localidad     String
  tipovivienda  String
  familiaresnum Int
  estrato       Int
  etnico        String

  usuarioInformacionPersonal informacionUsuario @relation(fields: [idUsuario], references: [idUsuario], name: "conexionInformacionPersonal")

  @@map("informacionPersonal")
}

model condicionesvivienda {
  idcondicionesvivienda String @id @unique @default(uuid())
  idUsuario             String
  hacinamiento          String
  violencia             String
  servicios             Json
  problemas             Json
  tipozona              String

  usuarioCondicionesVivienda informacionUsuario @relation(fields: [idUsuario], references: [idUsuario], name: "conexionCondicionesVivienda")

  @@map("condicionesvivienda")
}

model educacion {
  ideducacion      String @id @unique @default(uuid())
  idUsuario        String
  tipocolegio      String
  nivelescolaridad String
  carrera          String
  periodo          String
  motivo           String
  matedificulta    Json
  nivelingles      String

  usuarioeducacion informacionUsuario @relation(fields: [idUsuario], references: [idUsuario], name: "conexionEducacion")

  @@map("educacion")
}

model situacionlaboral {
  idsituacionlaboral String @id @unique @default(uuid())
  idUsuario          String
  situacion          String
  ingresos           String
  sector             String
  jornada            String
  ascenso            String

  usuariosituacionlaboral informacionUsuario @relation(fields: [idUsuario], references: [idUsuario], name: "conexionSituacionLaboral")

  @@map("situacionlaboral")
}

model salud {
  idsalud         String @id @unique @default(uuid())
  idUsuario       String
  enfermecronica  String
  discapacidad    String
  suspsicoactivas String
  alcohol         String
  Internet        String
  nicotina        String
  eps             String
  asispsicologo   String

  usuariosalud informacionUsuario @relation(fields: [idUsuario], references: [idUsuario], name: "conexionSalud")

  @@map("salud")
}
//GHQ12 + Tests:
model GHQ12 {
  idGHQ12             String @id @unique @default(uuid())
  idUsuario           String 
  telefonoPersonal    String
  tratDatos           String   @default("")
  historial           Json
  Puntaje             Int      @default(0) // Campo para almacenar el puntaje total
  preguntaActual      Int      @default(0) // Campo para almacenar la pregunta actual
  resPreg             Json     @default("{\"0\":[],\"1\":[],\"2\":[],\"3\":[]}")

  usuarioGHQ12 informacionUsuario @relation(fields: [idUsuario], references: [idUsuario], name: "conexionidGHQ12")
  usuarioHistorialTelefono informacionUsuario @relation(fields: [telefonoPersonal], references: [telefonoPersonal], name: "conexionHistorialTel")
}
//----------------------------------------------------------------------------------------------------------------------------------------------------------------------

//Agendamientos:------------------------------------------------------------------------------------------------------------------------------------------------
